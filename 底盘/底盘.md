<!--
 * @Author: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git
 * @Date: 2025-11-09 18:15:46
 * @LastEditors: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git
 * @LastEditTime: 2025-11-09 20:31:30
 * @FilePath: \rm_base-maind:\beifen\笔记\底盘\底盘.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
# 底盘

> 

## 底盘要完成的工作

* 运动学与动力学逆解算：根据遥控器或小电脑输入的控制信号，即底盘平动速度与角速度的目标值，解算到每个电机的速度or扭矩（或电流）目标值
    * 是底盘运动的根本
* 位姿与运动学解算：根据底盘陀螺仪与每个电机的数据，确定当前底盘的朝向，进而确定在场地坐标系（Odom系）下的速度与角速度的值
    * 底盘动力学闭环对电机的前馈、小陀螺、上坡功率分配时需要使用，后面也会发给小电脑用于自瞄的预判
    
## 底盘的运动学与动力学解算
* 正解：已知机器人各个机构的机械参数与运动状态，求解机器人整体的运动状态、位姿等数据
* 逆解：已知机器人各个机构的机械参数与整体的运动状态、位姿等数据，求解机器人各个机构的运动状态
* 运动学：关注机器人的运动状态。以及位姿信息
    * 倾向于研究加速度、角加速度、角速度、位置、姿态，即速度导致位置的改变
* 动力学：更多关注机器人的受力情况与运动状态的关系
    * 倾向于研究受到的力，以及引发旋转的力矩，还有因此对应的加速度、角加速度等，即受力导致运动状态的改变
## 底盘控制框架
* 将底盘的整体运动状态与底盘的轮组的电机建立映射关系
    * 底盘运动的目标速度有两个自由度   
    * 规定了底盘的旋转中心（云台轴线投影点），旋转属性只需要一个自由度（$ \omega $）
    * 输入逆解算系统中的需要三个变量（三维的向量）
* 问题：使用PI速度环负责将目标速度转化为电机扭矩（电流）    
   $ τ=K_p​(v_ref​−v)+K_i​∫(v_ref​−v)dt $
   * 这种方式只关注单个电机的输出情况，但是当一个轮被其他的轮子牵着或者牵着其他轮子，此时速度也符合目标速度，此时不再调整
   * 但是电机谁来提供力矩是由系统内部力平衡决定的
   * 这样会产生非唯一解，而PI控制器无法找出其中能量最优的选择
* 解决方法：力控（扭矩）前馈
    * *扭矩前馈*的思想就是：提前根据模型计算出理论上需要的电机扭矩，然后直接叠加到 PI 控制输出中。
    * $ τ_i​=K_p​(v_{ref,i}​−v_i​)+Ki​∫(v_{ref,i}​−v_i​)dt+τ_{ff,i}​ $
    * 对底盘进行平动速度与角速度的闭环控制，控制量为底盘牵引力与转矩。将底盘牵引力与转矩解算到每个电机上作为扭矩（电流）前馈



